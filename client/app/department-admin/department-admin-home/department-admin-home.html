<div class="department-admin-home">
  <div
    class="action-message"
    ng-class="{
      'text-success': (vm.actionMessageColor === 'success'),
      'text-danger': (vm.actionMessageColor === 'danger')
    }"
    ng-if="vm.actionMessage"
  >
    {{ vm.actionMessage }}
  </div>

  <section class="department-users">
    <div class="header-white">
      <div class="br-pagetitle">
        <h2 class="mb-2">Department Users</h2>
      </div>

      <nav class="section-nav-tabs">
        <ul class="nav nav-outline active-info align-items-start flex-column flex-md-row" role="tablist" id="nav-tab">
          <li class="nav-item tx-medium pl-0">
            <a
              class="nav-link active"
              data-toggle="tab"
              href="#nav-user-access"
              role="tab"
              id="nav-user-access-tab"
              aria-controls="nav-user-access"
              aria-selected="true"
              ng-click="vm.handleTabClick('user-access')"
            >
              User Access
            </a>
          </li>
          <li class="nav-item tx-medium">
            <a
              class="nav-link"
              data-toggle="tab"
              href="#nav-preferences"
              role="tab"
              id="nav-preferences-tab"
              aria-controls="nav-preferences"
              aria-selected="false"
              ng-click="vm.handleTabClick('preferences')"
            >
              Preferences
            </a>
          </li>
        </ul>
      </nav>
    </div>

    <div class="br-pagebody">
      <div class="tab-content" id="nav-tabContent">
        
        <div class="tab-pane fade show active" id="nav-user-access" role="tabpanel" aria-labelledby="nav-user-access-tab">
          <div class="card mg-b-25">
            <div class="card-header mb-3">
              <h6 class="card-title">User Access</h6>
            </div>
            <div class="card-body">

              <button class="btn-sm btn mr-2 btn-alt-2" ng-click="vm.createNewUser()"><span class="fa fa-plus">&nbsp</span>Add New User</button>

              <div class="department-users-table mb-5">
                <div class="table-row header">
                  <div class="cell">
                    Username
                  </div>
                  <div class="cell">
                    Name
                  </div>
                  <div class="cell">
                    Email
                  </div>
                  <div class="cell">
                    Permissions
                  </div>
                  <div class="cell">
                    Status
                  </div>
                  <div class="cell">
                    Action
                  </div>
                </div>

                <div class="table-row" ng-repeat="user in vm.users | orderBy:'first_name'">
                  <div class="cell username" data-title="Username">
                    {{ user.username }}
                  </div>
                  <div class="cell name" data-title="Name" ng-attr-title="{{ user.name }}">
                    {{ user.first_name }} {{ user.last_name }}
                  </div>
                  <div class="cell email" data-title="Email" ng-attr-title="{{ user.email }}">
                    {{ user.email }}
                  </div>
                  <div class="cell permissions" data-title="Permissions">
                    <div class="space-nowrap" ng-if="user.isDepartmentAdmin">
                      <i class="fa fa-check text-success"></i> Admin
                    </div>
                    <div class="space-nowrap" ng-if="user.isIngest">
                      <i class="fa fa-check text-success"></i> Ingest
                    </div>
                  </div>
                  <div class="cell status" data-title="Status">
                    <span class="badge badge-success" ng-if="user.isDashboardUser">Approved</span>
                    <span class="badge badge-warning" ng-if="!user.isDashboardUser">Pending</span>
                  </div>
                  <div
                    class="cell action"
                    ng-class="{'current-user': user._id === vm.principal._id}"
                    data-title="Action"
                  >
                    <div class="dropdown d-inline-block">
                      <div class="dropdown-button" data-toggle="dropdown">
                        <i class="fa fa-angle-down"></i>
                      </div>
                      <div class="dropdown-menu">
                        <nav class="nav nav-style-2 flex-column">
                          <div class="nav-link" ng-show="!user.isDashboardUser" ng-click="vm.approveAccess(user)">
                            <i class="fa fa-2x fa-check-circle"></i>
                            <span>Approve Access</span>
                          </div>
                          <div class="nav-link" ng-show="!user.isIngest" ng-click="vm.revokeAccess(user)">
                            <i class="fa fa-2x fa-times-circle"></i>
                            <span>Revoke Access</span>
                          </div>
                        </nav>
                      </div><!-- dropdown-menu -->
                    </div><!-- dropdown -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="tab-pane fade" id="nav-preferences" role="tabpanel" aria-labelledby="nav-preferences-tab">
          <div class="card mg-b-25">
            <div class="card-header mb-3">
              <h6 class="card-title">Preferences</h6>
            </div>
            <div class="card-body">
              <div class="form-group">
                <button type="button" class="btn btn-alt-2 btn-sm" ngf-select="vm.upload($file)" ng-model="file">Upload Logo</button>
              </div>
              <div class="form-group" ng-show="!file.$error && file">
                <img ngf-src="!file.$error && file" ngf-resize="{width: 100, height: 100, quality: 0.9}"/>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>

  </section>
</div>
